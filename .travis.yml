sudo: required

language: python
python:
    - "3.6"
services:
  - docker

install:
  -  pip install python-coveralls

before_install:
  - deployment/build-server.sh .
  - deployment/run-server.sh
  - docker ps -a

script:
  - docker exec server-container pytest --cov-report term-missing --cov=.

after_success:
  - docker cp server-container:/src/.coverage .coverage.docker
  - coverage combine
  - coveralls

after_script:
  - docker rm -f server-container